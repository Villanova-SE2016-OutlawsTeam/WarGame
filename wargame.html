<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>War Game</title>
	
    <link rel="stylesheet" href="wargame.css" type="text/css" />
</head>
<body>

<!-- Render War Game main component --> 
<h1>War Game</h1>
<div id='war_game'>
<h1 id="whichPlayer"> </h1>
<table>
	<tr>
		<th colspan=2 class="left">Player 1</th>
        <th></th>		
        <th></th>       
		<th colspan=2 class="right">Player 2</th>
	</tr>

    <tr>
        <td id="player1" class="col1" onclick="cardClick('player1')">
             <img src="card_images/backface.png" class="backface">
        </td>
		
		<td id="battlefield1" class="col2"></td>
		
		<td id="nomansland" class="col3">
			<!-- Deal cards and remove start button on click -->
			<div id="start">
				<img onclick="dealDeck(event)" src="other_images/StartButton.png">
			</div>
		</td>
		
		<td> 
		<td id="battlefield2" class="col4">            
        </td>
		
        <td id="player2" class="col5" onclick="cardClick('player2')">
            <img src="card_images/backface.png" class="backface">
        </td>
    </tr>   

</table>
</div>

<script src="Deck.js"></script>
<script type="text/javascript">

var imageTag = ""
var image_dir="card_images/"
var playerPlayed = ""

// Create 2 players
p1 = new Player(GameConstants.HUMAN, GameConstants.PLAYER1)
p2 = new Player(GameConstants.COMPUTER, GameConstants.PLAYER2)

function dealDeck(event) {
    //removing the wargame image
    event.target.parentNode.remove(); 

    //making the backfaces visible for each player
    backfaces = document.getElementsByClassName("backface")
    for (var i = 0; i < backfaces.length; i++) {
        thisCard = backfaces[i];
        thisCard.style.visibility = "visible"
    }
    
    starting_deck = new Deck()
	starting_deck.create_deck()
	starting_deck.shuffle()

	var deck_count = starting_deck.count()

	for (var i = 0; i < deck_count; i++) {
		card = starting_deck.pop()

		if (i % 2 == 0) {
			p1.active_deck.add(card)
		} else {
			p2.active_deck.add(card)
		}
	}
}

function cardClick(playerNumber){

    var imageTag = ""
    var image_dir="card_images/"
	var whichPlayer = playerNumber;
	
	
	
    if(playerNumber == GameConstants.PLAYER1){
		
		if (playerPlayed == GameConstants.PLAYER1){
			var playerTag = "" + whichPlayer + "'s turn is over" 
			document.getElementById("whichPlayer").innerHTML = playerTag
			return false;
		} else{
			var card = p1.active_deck.pop()
			if(card){
				var card_img_file = image_dir + card.id + ".png"
				var imageTag = "<img src='" + card_img_file + "' />"
				var playerTag = "" + whichPlayer + " is playing " 
				document.getElementById("whichPlayer").innerHTML = playerTag
				document.getElementById(GameConstants.BATTLEFIELD1).innerHTML = imageTag
			    playerPlayed = GameConstants.PLAYER1 
			}
		   
		}
    } else{
	
		if (playerPlayed == GameConstants.PLAYER2){
			var playerTag = "" + whichPlayer + "'s turn is over"  
			document.getElementById("whichPlayer").innerHTML = playerTag
			return false;
		}
	else{
        var card = p2.active_deck.pop()
        if(card){
            var card_img_file = image_dir + card.id + ".png"
            var imageTag = "<img src='" + card_img_file + "' />"
			var playerTag = " " + whichPlayer + " is playing " 
			document.getElementById("whichPlayer").innerHTML = playerTag
            document.getElementById(GameConstants.BATTLEFIELD2).innerHTML = imageTag
			playerPlayed = GameConstants.PLAYER2
			}
        }
    }
}



</script>

</body>
</html>